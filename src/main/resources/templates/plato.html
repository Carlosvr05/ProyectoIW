<!DOCTYPE html>
<html class="h-100" xmlns:th="http://www.thymeleaf.org">

<head>
    <th:block th:replace="~{fragments/head :: header}" />
    <title>MenUni: Carta</title>
</head>

<body class="d-flex flex-column h-100">
    <header th:replace="~{fragments/nav.html :: nav}"></header>

    <main class="flex-shrink-0">
        <div class="container mt-5 mb-5">
            <h1 class="mb-4 text-center">Nuestros Platos</h1>

            <div class="row row-cols-1 row-cols-md-3 g-4">

                <div class="col">
                    <div class="card h-100 shadow-sm plato-card">
                        <img th:src="@{/img/Hamburguesa-clasica.png}" class="card-img-top" alt="Hamburguesa" 
                             style="height: 200px; object-fit: cover;">
                        
                        <div class="card-body d-flex flex-column">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <h5 class="card-title mb-0">Hamburguesa Clásica</h5>
                                <span class="badge bg-success rounded-pill fs-6 precio-base" data-precio="8.50">8.50 €</span>
                            </div>
                            
                            <p class="card-text text-muted flex-grow-1">
                                Carne 100% vacuno con lechuga, tomate fresco y nuestra salsa especial.
                            </p>
                            
                            <div class="mt-3">
                                <div class="row g-2">
                                    <div class="col-4">
                                        <input type="number" class="form-control input-cantidad" value="1" min="1">
                                    </div>
                                    <div class="col-8">
                                        <button class="btn btn-primary w-100">
                                            Añadir (<span class="precio-total">8.50</span> €)
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col">
                    <div class="card h-100 shadow-sm plato-card">
                        <img th:src="@{/img/Pizza-Margarita.png}" class="card-img-top" alt="Pizza" 
                             style="height: 200px; object-fit: cover;">
                        
                        <div class="card-body d-flex flex-column">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <h5 class="card-title mb-0">Pizza Margarita</h5>
                                <span class="badge bg-success rounded-pill fs-6 precio-base" data-precio="10.00">10.00 €</span>
                            </div>
                            
                            <p class="card-text text-muted flex-grow-1">
                                Base fina con tomate San Marzano, mozzarella y albahaca fresca.
                            </p>
                            
                            <div class="mt-3">
                                <div class="row g-2">
                                    <div class="col-4">
                                        <input type="number" class="form-control input-cantidad" value="1" min="1">
                                    </div>
                                    <div class="col-8">
                                        <button class="btn btn-primary w-100">
                                            Añadir (<span class="precio-total">10.00</span> €)
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="col">
                    <div class="card h-100 shadow-sm plato-card">
                        <img th:src="@{/img/Ensalada-Cesar.png}" class="card-img-top" alt="Ensalada" 
                             style="height: 200px; object-fit: cover;">
                        
                        <div class="card-body d-flex flex-column">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <h5 class="card-title mb-0">Ensalada César</h5>
                                <span class="badge bg-success rounded-pill fs-6 precio-base" data-precio="7.50">7.50 €</span>
                            </div>
                            
                            <p class="card-text text-muted flex-grow-1">
                                Lechuga romana, pollo a la parrilla, picatostes y salsa césar casera.
                            </p>
                            
                            <div class="mt-3">
                                <div class="row g-2">
                                    <div class="col-4">
                                        <input type="number" class="form-control input-cantidad" value="1" min="1">
                                    </div>
                                    <div class="col-8">
                                        <button class="btn btn-primary w-100">
                                            Añadir (<span class="precio-total">7.50</span> €)
                                        </button>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </main>

    <th:block th:replace="~{fragments/footer.html :: footer}" />

    <script>
        // Seleccionamos todas las tarjetas que tengan la clase 'plato-card'
        document.querySelectorAll('.plato-card').forEach(card => {
            
            // Dentro de cada tarjeta, buscamos sus elementos
            const input = card.querySelector('.input-cantidad');
            const precioBaseElem = card.querySelector('.precio-base');
            const precioTotalElem = card.querySelector('.precio-total');

            // Obtenemos el precio numérico del atributo data-precio (ej: "8.50")
            const precioBase = parseFloat(precioBaseElem.getAttribute('data-precio'));

            // Añadimos un "escucha" para cuando el usuario cambie el número
            input.addEventListener('change', function() {
                actualizarPrecio();
            });
            
            // También escuchamos 'keyup' por si escribe el número con teclado
            input.addEventListener('keyup', function() {
                actualizarPrecio();
            });

            function actualizarPrecio() {
                let cantidad = parseInt(input.value);
                
                // Evitamos números negativos o vacíos
                if (isNaN(cantidad) || cantidad < 1) {
                    cantidad = 1;
                }

                // Calculamos el total
                let total = (precioBase * cantidad).toFixed(2); // toFixed(2) asegura 2 decimales
                
                // Actualizamos el texto del botón
                precioTotalElem.textContent = total;
            }
        });
    </script>
</body>

</html>